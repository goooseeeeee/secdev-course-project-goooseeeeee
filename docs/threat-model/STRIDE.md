# STRIDE — Угрозы и контроли

| Поток/Элемент               | Угроза (S/T/R/I/D/E) | Описание угрозы                                                                 | Контроль                                                                                   | Ссылка на NFR          | Проверка/Артефакт                                  |
|-----------------------------|-----------------------|----------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|-------------------------|----------------------------------------------------|
| F1 (User → Backend)         | S (Spoofing)          | Злоумышленник может выдать себя за пользователя и получить доступ к чужим данным | JWT-аутентификация, проверка подписи токена, HTTPS                                         | NFR-01, NFR-05          | Postman / Unit тесты / Security Headers Report     |
| F1 (User → Backend)         | T (Tampering)        | Перехват и подмена данных при передаче                                          | TLS ≥ 1.2, HSTS                                                                            | NFR-05                  | OWASP ZAP / Security Headers Report                |
| F2 (Backend → Wishlist Logic) | I (Information Disclosure) | Возможна утечка данных между сервисами через логи или незащищённые каналы       | Ограничение логов, внутренний API, IAM                                                     | NFR-07                  | Code review / CI-CD                               |
| F3 (Wishlist Logic → DB)    | T (Tampering)        | Вмешательство в SQL-трафик или несанкционированная модификация данных            | TLS для БД, ограниченные роли БД, SQL параметризация                                      | NFR-05, NFR-07          | Security тесты / Code review                       |
| F3 (Wishlist Logic → DB)    | R (Repudiation)      | Отсутствие доказательств того, кто изменил данные                               | Аудит логов БД                                                                            | NFR-04                  | Grafana / Логи                                    |
| F4 (Export Storage)         | I (Information Disclosure) | Утечка экспортированных файлов с персональными данными                           | Контроль доступа, TTL ссылок, S3 ACL / Local FS ACL                                        | NFR-07                  | Vault / CI-CD                                     |
| F5 (User → Backend)         | S (Spoofing)          | Злоумышленник может запросить чужой экспорт                                     | Проверка токена пользователя, валидация сессии                                            | NFR-01, NFR-05          | Unit тесты / Postman                              |
| F6 (Backend → Export Storage) | D (Denial of Service) | Возможность перегрузки экспорта массовыми запросами                              | Rate limiting, ограничение размера файла                                                  | NFR-03, NFR-04          | k6 / Grafana                                      |
| Auth Component              | E (Elevation of Privilege) | Получение прав администратора обычным пользователем                             | RBAC / ограничение ролей                                                                  | NFR-01                  | Security тесты / Code review                       |
